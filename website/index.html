<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evo - Your AI Companion</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg {
            background: linear-gradient(-45deg, #1a202c, #2d3748, #4a5568, #2d3748);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .page-view { display: none; }
        .feature-item { display: flex; align-items: flex-start; gap: 0.75rem; }
        .feature-icon { flex-shrink: 0; margin-top: 5px; }
        .main-content { transition: margin-right 0.3s ease-in-out; }
        .side-panel {
            transition: transform 0.3s ease-in-out;
            transform: translateX(100%);
        }
        .side-panel.open { transform: translateX(0); }
    </style>
</head>
<body class="gradient-bg text-white antialiased overflow-x-hidden">

    <div class="relative min-h-screen flex">
        <!-- Main Content Area -->
        <main id="main-content" class="flex-1 w-full flex flex-col items-center justify-center p-4">
            <!-- All pages will be rendered here -->
            
            <!-- LANDING PAGE -->
            <div id="landing-page" class="w-full max-w-5xl mx-auto">
                <h1 class="text-6xl font-black text-center mb-12 bg-gradient-to-r from-indigo-400 to-purple-500 bg-clip-text text-transparent">Evo</h1>
                <div class="bg-gray-800 bg-opacity-50 backdrop-blur-sm rounded-2xl shadow-2xl p-8 md:p-12 grid md:grid-cols-2 gap-12 items-center">
                    <div class="space-y-6">
                        <h2 class="text-4xl font-bold tracking-tighter text-white">Evolve Your Community</h2>
                        <p class="text-lg text-gray-300">
                            An AI companion that learns, remembers, and grows with your server. Invite Evo to bring a new level of interactive fun to your members.
                        </p>
                        <a id="login-btn" href="#" class="inline-block bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-transform transform hover:scale-105">
                            Sign In & Set Up
                        </a>
                    </div>
                    <div class="bg-gray-900/70 rounded-xl p-6 border border-gray-700 space-y-4">
                        <h3 class="text-xl font-bold text-indigo-300 mb-4">Evo Features:</h3>
                        <div class="feature-item">
                            <svg class="w-5 h-5 text-green-400 feature-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V4a2 2 0 012-2h8z"></path></svg>
                            <div><h4 class="font-semibold">Human-like Replies</h4><p class="text-sm text-gray-400">Responds to her name, @mentions, or replies.</p></div>
                        </div>
                        <div class="feature-item">
                            <svg class="w-5 h-5 text-green-400 feature-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                            <div><h4 class="font-semibold">Persistent Memory</h4><p class="text-sm text-gray-400">Remembers your conversations and key facts about users.</p></div>
                        </div>
                        <div class="feature-item">
                            <svg class="w-5 h-5 text-yellow-400 feature-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.293 2.293a1 1 0 010 1.414L10 16l-4 4-4-4 5.293-5.293a1 1 0 011.414 0z"></path></svg>
                            <div><h4 class="font-semibold">Premium Customization</h4><p class="text-sm text-gray-400">Change her name, avatar, and core personality.</p></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SERVER DASHBOARD -->
            <div id="server-dashboard" class="page-view w-full max-w-4xl">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-4xl font-bold">Your Servers</h1>
                    <a id="invite-bot-btn" href="#" target="_blank" class="bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-4 rounded-lg shadow-lg">Invite Bot</a>
                </div>
                <div id="server-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
                    <div id="add-server-card" class="bg-gray-800 bg-opacity-50 backdrop-blur-sm rounded-2xl aspect-square flex items-center justify-center cursor-pointer border-2 border-dashed border-gray-600 hover:border-indigo-400 hover:bg-gray-700 transition-all">
                        <div class="text-center">
                            <svg class="w-16 h-16 text-gray-500 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                            <p class="mt-2 font-semibold text-gray-400">Add Server</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SERVER SETTINGS -->
            <div id="server-settings" class="page-view w-full max-w-2xl">
                 <button class="back-to-dashboard-btn mb-6 text-indigo-400 hover:text-indigo-300 font-semibold">&larr; Back to Dashboard</button>
                 <!-- Settings content remains the same -->
            </div>

            <!-- PLACEHOLDER PAGES -->
            <div id="premium-page" class="page-view"><h1>Premium Page - Under Maintenance</h1></div>
            <div id="faq-page" class="page-view"><h1>FAQ Page - Under Maintenance</h1></div>
            <div id="changelog-page" class="page-view"><h1>Changelog Page - Under Maintenance</h1></div>
            
        </main>

        <!-- Right Side Panel -->
        <div id="side-panel" class="fixed top-0 right-0 h-full w-64 bg-gray-900/80 backdrop-blur-md border-l border-gray-700 p-6 space-y-6 z-40">
            <div id="user-info" class="text-center">
                <p class="font-bold text-white">Not Logged In</p>
                <p class="text-xs text-gray-400">#0000</p>
            </div>
            <nav class="flex flex-col space-y-2">
                <button data-page="server-dashboard" class="side-nav-link text-left w-full hover:bg-gray-700 p-2 rounded">Dashboard</button>
                <button data-page="premium-page" class="side-nav-link text-left w-full hover:bg-gray-700 p-2 rounded">Premium</button>
                <button data-page="faq-page" class="side-nav-link text-left w-full hover:bg-gray-700 p-2 rounded">FAQ</button>
                <button data-page="changelog-page" class="side-nav-link text-left w-full hover:bg-gray-700 p-2 rounded">Changelog</button>
            </nav>
            <button id="logout-btn" class="w-full bg-red-800 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">Logout</button>
        </div>
        
        <!-- Hamburger menu for mobile -->
        <button id="menu-toggle-btn" class="fixed top-4 right-4 z-50 text-white md:hidden">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
        </button>
    </div>

    <!-- MODALS -->
    <div id="remove-confirm-modal" style="display: none;" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50">
        <div class="bg-gray-800 rounded-2xl w-full max-w-md shadow-2xl p-8 text-center">
            <h2 class="text-2xl font-bold mb-4">Are you sure?</h2>
            <p class="text-gray-300 mb-6">All settings for this server will be permanently lost. Evo's memories of users from this server will be permanently wiped. This action cannot be undone.</p>
            <div class="flex justify-center gap-4">
                <button id="cancel-remove-btn" class="w-full bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-6 rounded-lg">Cancel</button>
                <button id="confirm-remove-btn" class="w-full bg-red-600 hover:bg-red-500 text-white font-bold py-3 px-6 rounded-lg">Confirm & Remove</button>
            </div>
        </div>
    </div>
    <!-- Other modals remain the same -->


    <script>
        const API_BASE_URL = 'https://evo-app-aiop.onrender.com';
        // IMPORTANT: Replace with your bot's actual Client ID
        const BOT_CLIENT_ID = 'YOUR_BOT_CLIENT_ID_HERE'; 
        const BOT_PERMISSIONS = '379968'; // Permissions for Send/Read Messages, Manage Webhooks, Change Nickname

        // --- GLOBAL STATE ---
        let currentServer = null;
        let isUserLoggedIn = false;
        let botInfo = {};

        // --- DOM ELEMENTS ---
        const mainContent = document.getElementById('main-content');
        const sidePanel = document.getElementById('side-panel');
        const menuToggleBtn = document.getElementById('menu-toggle-btn');
        // ... other elements
        const inviteBotBtn = document.getElementById('invite-bot-btn');

        // --- PAGE NAVIGATION & UI ---
        function showPage(pageId) {
            document.querySelectorAll('#main-content > .page-view, #main-content > #landing-page').forEach(p => p.style.display = 'none');
            const page = document.getElementById(pageId);
            if (page) page.style.display = 'block';
        }

        function setupUIForLogin(loggedIn) {
            isUserLoggedIn = loggedIn;
            if (loggedIn) {
                sidePanel.classList.add('open');
                menuToggleBtn.classList.remove('md:hidden');
                mainContent.classList.add('md:mr-64');
                showPage('server-dashboard');
            } else {
                sidePanel.classList.remove('open');
                menuToggleBtn.classList.add('md:hidden');
                mainContent.classList.remove('md:mr-64');
                showPage('landing-page');
            }
        }
        
        // Event Listeners
        menuToggleBtn.addEventListener('click', () => sidePanel.classList.toggle('open'));
        document.querySelectorAll('.side-nav-link').forEach(link => {
            link.addEventListener('click', () => {
                showPage(link.dataset.page);
                if (window.innerWidth < 768) sidePanel.classList.remove('open'); // Close on mobile
            });
        });
        
        // Point 4: Setup invite link
        inviteBotBtn.href = `https://discord.com/oauth2/authorize?client_id=1399503221650620656`;

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', async () => {
            await fetchBotInfo();
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('loggedin') === 'true') {
                history.pushState(null, '', window.location.pathname);
                await updateUserInfo();
                if (isUserLoggedIn) {
                    loadAndRenderServerDashboard();
                    setupUIForLogin(true);
                }
            } else {
                await updateUserInfo();
                if (isUserLoggedIn) {
                    loadAndRenderServerDashboard();
                    setupUIForLogin(true);
                } else {
                    setupUIForLogin(false);
                }
            }
        });
        
        // All other JS functions (fetchBotInfo, updateUserInfo, etc.) remain the same
        // ...
    </script>
</body>
</html>
